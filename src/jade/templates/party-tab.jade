script(type="text/ng-template", id="party-tab")
  div(fill-height, offset="40")
    .player-block
      .text-center Members
      .margin-bottom-20(ng-repeat="player in players")
        .row
          .col-xs-12 {{player.hp.atMin() ? '(DEAD)' : ''}} {{player.name}} the {{player.professionInst.title}}

        .row
          .col-xs-12 Level {{player.level}} {{player.getAlign()}} {{player.race}} {{player.profession}}

        .row
          .stat-block.col-xs-4 HP:{{player.hp.cur}}/{{player.hp.max}}
          .stat-block.col-xs-4 MP:{{player.mp.cur}}/{{player.mp.max}}
          .stat-block.col-xs-4 XP:{{player.xp.cur}}/{{player.xp.max}}

        .row
          .stat-block.col-xs-2 STR:{{player.getStat('str')}}
          .stat-block.col-xs-2 DEX:{{player.getStat('dex')}}
          .stat-block.col-xs-2 CON:{{player.getStat('con')}}
          .stat-block.col-xs-2 INT:{{player.getStat('int')}}
          .stat-block.col-xs-2 WIS:{{player.getStat('wis')}}
          .stat-block.col-xs-2 CHA:{{player.getStat('cha')}}

    .inventory-block
      uib-tabset(justified="true")
        uib-tab(ng-repeat="player in players", heading="{{player.name}}")
          div(fill-height, offset="{{inventoryOffset()}}")
            .margin-bottom-20(ng-include="'player-skills'")
            .margin-bottom-20(ng-include="'player-equipment'")
            div(ng-include="'player-inventory'")

script(type="text/ng-template", id="player-item")
  .col-xs-1.item-glyph(ng-style="{'color': item.glyph.fg}") {{item.glyph.key}}
  .col-xs-8.item-name
    | {{item.charges}}
    | {{item.name || '(empty)'}}
    span(ng-if="item.slotsTaken > 1") &nbsp;({{item.slotsTaken}} slots)
  .col-xs-3.item-actions(ng-if="item")
    .btn-group.dropup(uib-dropdown)
      button.btn.btn-link(uib-dropdown-toggle)
        | Act
        span.caret
      ul.uib-dropdown-menu.dropdown-menu-right
        li
          a.btn.btn-link(ng-if="player.canEquip(item) && !player.isEquipped(item)", ng-click="player.equip(item)") Equip
          a.btn.btn-link(ng-if="player.isEquipped(item)", ng-click="player.unequip(item)", ng-disabled="item.isCursed()") Unequip
          a.btn.btn-link(ng-if="item.canUse(player) && !player.isEquipped(item)", ng-click="item.use(player)") Use
          a.btn.btn-link(ng-click="player.dropItem(item)") Drop

script(type="text/ng-template", id="player-skills")
  .row.text-center Skills
  .row(ng-repeat="(type, data) in player.skills | orderBy:'type'")
    .col-xs-3.skill-name {{_.capitalize(type)}}
    .col-xs-6.skill-value {{player.getSkillLevel(type).name}}
    .col-xs-3.skill-current ({{data.cur}}/{{data.max}})

script(type="text/ng-template", id="player-equipment")
  .row.text-center Equipment
  .row(ng-repeat="(slotName, count) in player.raceInst.slots")
    .col-xs-12.slot-name > {{_.capitalize(slotName)}} ({{player.equipment[slotName].length || 0}}/{{count}} slots used)
    .col-xs-12(ng-repeat="item in player.equipment[slotName]", ng-include="'player-item'")

script(type="text/ng-template", id="player-inventory")
  .row.text-center Inventory ({{player.inventory.length}} items)
  .row.item(ng-if="player.inventory.length === 0")
    .col-xs-12.text-center Empty
  .row.item(ng-repeat="item in player.inventory | orderBy:'name'", ng-include="'player-item'")